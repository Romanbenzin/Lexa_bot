# Установить все зависимости
pip install -r requirements.txt

"Удалены файлы, перечисленные в .gitignore"
git rm -r --cached .
git add .
git commit -m

# Удалить из отслеживания гитом файлы
git rm --cached .\pass_bot.py
git rm --cached .\draft.py

# Документация по боту
https://pytba.readthedocs.io/ru/latest/quick_start.html

[Unit]
Description=My Bot Service
After=network.target

[Service]
User=benzin
WorkingDirectory=/home/benzin/Lexa_bot
ExecStart=/usr/bin/python3 /home/benzin/Lexa_bot/bot.py
Restart=always

[Install]
WantedBy=multi-user.target

# Запустить поочередно и обновления будут приняты
sudo systemctl daemon-reload
sudo systemctl stop mybot.service
sudo systemctl start mybot.service
sudo systemctl status mybot.service
sudo systemctl enable mybot.service     # автозапуск при перезагрузке

/etc/systemd/system

# Обновить ветку из папки Lexa_bot
git pull origin main

# Если потерялся гит
git remote add origin https://github.com/Romanbenzin/Lexa_bot.git

# Переезд в докер:
docker build -t bot .                           # Сделать образ на основе dockerfile
docker ps                                       # Проверить запущенные контейнеры
docker ps -a                                    # Проверить все контейнеры
docker images                                   # Все контейнеры
docker run -it bot                              # Запустить контейнер
docker run -d --restart unless-stopped bot      # Запустить контейнер фоново
docker stop 56e133d13904                        # Остановить контейнер по ID
docker container prune                          # Удалить не запущенные контейнеры

# Запустить бота руками:
$env:PYTHONPATH="."; telegram_bot/python3 bot.py
python telegram_bot/bot.py

# При обновлении:
1. из папки с ботом:
sudo docker build -t bot .
2. Проверить запущенные контейнеры:
sudo docker ps
3. Стопнуть контейнер по ID или Имени:
sudo docker stop ID
4. Проверить образы:
sudo docker image ls
5. Удалить старый образ:
sudo docker rmi ddf9f47f661d
6. Запустить бота:
sudo docker run -d --restart unless-stopped bot


# SQL
postgresql-x64-15
sudo service postgresql start

# Для кодировки в терминале:
chcp 1251

# Подключиться к базе:
psql -U postgres -d my_bot_db

# Создал базу:
CREATE DATABASE my_bot_db;
# Переключился на базу:
\c my_bot_db;
# Создал таблицу:
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    user_name TEXT NOT NULL,
    sucker BOOLEAN DEFAULT TRUE
);
# Таблицы:
\dt
# Удалить таблицу:
DROP TABLE users;

# Добавить столбец
ALTER TABLE users ADD COLUMN "Sucker" BOOLEAN SET default TRUE;

# Добавить в таблицу:
INSERT INTO users (user_name) VALUES ('@user_name');
